<!DOCTYPE html>
<html>

  <head>
    <title>Preview URL</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      * { box-sizing: border-box; }
      body { font-family: verdana/*geneva*/; }
.closeButton {
    background-color: silver;
    border: 2px solid silver;
    border-radius: 5px;
    padding: 1px;
    position: absolute;
    top: 2px;
    left: 2px;
    cursor: pointer;
}
.closeButton:hover {
    border: 2px solid black;
}

    </style>
    <script>

//--------------------------------------------------------------------------------
// TRY TO FORCE IFRAME INITIAL "about:blank" EVERY TIME
var iframeElement = null;
const kInitialURL = 'https://example.com';//'about:blank';
//--------------------------------------------------------------------------------

function toggleViewURL(button)
{
    if (button == null) {
	button = document.getElementById('buttonViewURL');
	if (button == null) {
	    return alert('ERROR: button NOT FOUND!');
	}
    }

    let div = document.getElementById('viewURL');
    if (div.style.display == 'none') {

	let container = document.getElementById('iframeContainer');
	if (iframeElement == null) {
	    let iframe = document.createElement('iframe');
	    iframe.id = "iframeURL";
	    iframe.title = "Inline Frame Example";
	    iframe.src = kInitialURL;
	    iframe.style.border = "3px solid gray";
	    iframe.style.width = "90%";
	    iframe.style.height = "90%";
	    iframe.style.marginLeft = "20px";
	    container.appendChild(iframe);
	    iframeElement = iframe;
	    let input = document.getElementById('inputURL');
	    if (input != null) {
		input.value = kInitialURL;
	    }
	} else {
            // DON'T CREATE UNNECESSARY WEB REQUESTS BY RE-CREATNG AND RE-LOADING
            console.info('iframe element already exists, not reloading');
	}

	let rect = button.getBoundingClientRect();
	// console.log('button rect = ', rect);

	// PLACE WEBVIEW JUST BELOW & RIGHT OF THE BUTTON
	// div.style.top = 22; // rect.height + 10;
	// div.style.left = 112; // rect.width + 50;
	// NOT WORKING:-( div.style.left = rect.width;
	div.style.display = 'block';

	button.innerHTML = "HIDE WEBPAGE";
	button.style.color = "red";
    } else {
	div.style.display = 'none';
	button.innerHTML = "PREVIEW WEBPAGE";
	button.style.color = "green";
    }
}

function inputURLOnKeyUp(event, input)
{
    if (event.key == 'Enter') {
	let iframe = document.getElementById('iframeURL');
	if (iframe != null) {
	    // node.parentNode.removeChild(node);
	    iframe.src = input.value;
	    iframeURL = input.value;
	}
    }
}

//--------------------------------------------------------------------------------
// MOVINGDIV (MOVEABLE DIV) (30-OCT-2019)

var isMovingDiv = false;
var theMovingDivElement = null; // HAVE TO ADD THIS BECAUSE MOUSE MOVES "OFF OF" THE TARGET ELEMENT

function startMovingDiv(event)
{
//OOPS, CANNOT INPUT:    event.preventDefault();
    // console.log("startMovingDiv() = ");
    // console.log(event);
    isMovingDiv = true;
    theMovingDivElement = event.target;
}

function moveDiv(event)
{
    event.preventDefault(); // YUP: THIS WORKED!:-) [THANKS TO W3SCHOOLS!:-)]
    // event.stopPropagation(); NOPE: WHE MOUSE VENTURES OUTSIDE THE DIV, IT STILL HIGHLIGHTS/SELECTS THE UNDERLYING TEXT
    if (event.buttons > 0) {
	if (isMovingDiv) {
	    // console.log(event);
	    ////// let s = document.getElementsByClassName("movingDiv")[0]


	    // let s = event.target;
	    let s = theMovingDivElement;

	    // console.log("dx = " + event.movementX + " dy = " + event.movementY);
	    // console.log("b = " + s.style.bottom + " l = " + s.style.left);
	    if (s != null) {
		if (s.style != null) {
		    let b = parseInt(s.style.top);
		    let l = parseInt(s.style.left);
		    let newTop = (b + event.movementY);
		    let newLeft = (l + event.movementX);
		    s.style.top = (newTop >= 0 ? newTop : 0) + "px";
		    s.style.left = (newLeft >= 0 ? newLeft : 0) + "px";
		}
	    }
	}
    }
}

window.addEventListener("mousemove", moveDiv);

function stopMovingDiv(event)
{
    // console.log("stopMovingDiv() = ");
    // console.log(event);
    if (isMovingDiv) {
	// SEE: onmouseup EVENT IN RESIZER BAR
	// let s = document.getElementById("resultsSection");
	// saveResultsSectionSize(s);
	isMovingDiv = false;
	theMovingDivElement = null;
	/// let s = event.target;
	if (event != null) {
	    if (event.target != null) {
		if (event.target.id != null) {
		    // console.log(event.target);
		    localStorage.setItem(/*"movingDiv"*/event.target.className + "Bottom", event.target.style.top);
		    localStorage.setItem(/*"movingDiv"*/event.target.className + "Left", event.target.style.left);
		}
	    }
	}
    }
}

window.addEventListener("mouseup", stopMovingDiv);

// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

function showMovingDiv()
{
    let d = document.getElementsByClassName("movingDiv")[0];
    if (d != null) {
	d.style.opacity = 1.0;
	let c = document.getElementById("vuMeter");
	if (c != null) {
	    c.style.boxShadow = "";//null;
	}
    }
}

function hideMovingDiv()
{
    let d = document.getElementsByClassName("movingDiv")[0];
    if (d != null) {
	d.style.opacity = 0.0;
	let c = document.getElementById("vuMeter");
	if (c != null) {
	    c.style.boxShadow = "0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)";
	}
    }
}

function selectChanged(select)
{
    // var x = document.getElementById("mySelect").value;
    // document.getElementById("demo").innerHTML = "You selected: " + x;
    let button = document.getElementById("buttonViewURL");
    if (select.value == "click") {
        button.onclick = function () { toggleViewURL(button); };
        button.onmouseover = null;
    } else if (select.value == "mouseover") {
        button.onclick = null;
        button.onmouseover = function () { toggleViewURL(button); };
    }
}

</script>

  </head>

  <body>

    <h1>Preview URL</h1>

<!-- ---------------------------------------------------------------------------------------------------------------------- -->
<!-- VIEW WEBSITE (09-JUL-2021) -->

<p>
<select id="selectMethod" onchange="selectChanged(this)" selectedIndex="0" autocomplete="off">
  <option value="click" selected>CLICK BUTTON TO VIEW &amp; HIDE</option>
  <option value="mouseover">MOUSEOVER BUTTON TO VIEW &amp; HIDE</option>
</select>
</p>

<button id="buttonViewURL" onclick="toggleViewURL(this)" style="color:green;">PREVIEW WEBPAGE</button>
<div id="viewURL" style="z-index:9;
			 position:fixed;
			 top:0;
			 left:200px;
			 background-color:white;
			 opacity:0.9;
			 border:3px solid red;
			 display:none;
			 margin:0;
			 padding-left:10px;
			 padding-bottom:10px;
			 width:75%;
			 height:75%;
			 box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);"
	 onmousedown="startMovingDiv(event)">

<!--
  <span class="closeButton" onclick="toggleViewURL(null)"><b>&times</b></span>
  <table style="width:90%;height:90%;">
    <tr><td><input id="inputURL" type="text" size="80" onkeyup="inputURLOnKeyUp(event, this)"
		   style="width:90%;margin-bottom:5px;border:2px solid gray;" /></td></tr>
    <tr><td><iframe
	       id="iframeURL"
	       title="Inline Frame Example"
	       src="http://localhost/SecretWebsite/"
	       style="border:3px solid gray;/*width:50vw;height:50vh;*/width:90%;height:90%;">
	  This is text in the iframe tag
    </iframe></td></tr>
  </table>
-->
  <!--<span style="margin-left:20px;"><b>PRODUCT WEBPAGE</b></span>-->
  <span class="closeButton" onclick="toggleViewURL(null)"><b>&times</b></span>
  <input id="inputURL" type="text" size="80" onkeyup="inputURLOnKeyUp(event, this)"
	 style="width:90%;margin-bottom:5px;border:2px solid gray;margin-left:20px;margin-top:5px;"
	 value="https://example.com" placeholder="Enter web address" />
  <br />
<!-- src="http://localhost/SecretWebsite/" -->
<!-- src="" -->
<div id="iframeContainer" style="height:100%;width:100%;/* NEED TO BE SET SO iframe width % AND height % WORK */">
<!--
  <iframe id="iframeURL"
	  title="Inline Frame Example"
	  src="about:blank"
	  style="border:3px solid gray;width:90%;height:90%;margin-left:20px;">
    This is text in the iframe tag
  </iframe>
-->
</div>
</div>

<p id="debug">
</p>

<!-- VIEW WEBSITE (09-JUL-2021) -->
<!-- ---------------------------------------------------------------------------------------------------------------------- -->

</body>
</html>
